# [阿里巴巴规范](https://www.jianshu.com/p/4dc9c82f13d5)

建表规范

1. 【强制】表达是与否概念的字段,必须使用 is _ xxx 的方式命名,数据类型是 unsigned tinyint( 1 表示是,0 表示否 ) 。

   说明:任何字段如果为非负数,必须是 unsigned 。
   正例:表达逻辑删除的字段名 is_deleted ,1 表示删除,0 表示未删除。

2. 【强制】表名、字段名必须使用小写字母或数字 , 禁止出现数字开头,禁止两个下划线中间只出现数字。数据库字段名的修改代价很大,因为无法进行预发布,所以字段名称需要慎重考虑。

   说明：MySQL 在 Windows 下不区分大小写，但在 Linux 下默认是区分大小写。因此，数据库名、表名、字段名，都不允许出现任何大写字母,避免节外生枝。
   正例: aliyun _ admin , rdc _ config , level 3_ name
   反例: AliyunAdmin , rdcConfig , level _3_ name

3. 【强制】表名不使用复数名词。
   
   说明:表名应该仅仅表示表里面的实体内容,不应该表示实体数量,对应于 DO 类名也是单数形式，符合表达习惯。

4. 【强制】禁用保留字,如 desc 、 range 、 match 、 delayed 等,请参考 MySQL 官方保留字。
5. 【强制】主键索引名为 pk_ 字段名;唯一索引名为 uk _字段名 ;普通索引名则为 idx _字段名。
   
   说明: pk_ 即 primary key;uk _ 即 unique key;idx _ 即 index 的简称。

6. 【强制】小数类型为 decimal ，禁止使用 float 和 double 。
   
   说明: float 和 double 在存储的时候,存在精度损失的问题,很可能在值的比较时,得到不正确的结果。如果存储的数据范围超过 decimal 的范围,建议将数据拆成整数和小数分开存储。

7. 【强制】如果存储的字符串长度几乎相等,使用 char 定长字符串类型。
8. 【强制】 varchar 是可变长字符串,不预先分配存储空间,长度不要超过 5000,如果存储长度大于此值,定义字段类型为 text ,独立出来一张表,用主键来对应,避免影响其它字段索引效率。
9. 【强制】表必备三字段: id , gmt _ create , gmt _ modified 。

    说明:其中 id 必为主键,类型为 unsigned bigint 、单表时自增、步长为 1。 gmt_create、gmt_modified 的类型均为 datetime 类型，前者现在时表示主动创建，后者过去分词表示被动更新。

建表规范【推荐】

1. 【推荐】表的命名最好是加上“业务名称_表的作用”。

   正例: alipay _ task / force _ project / trade _ config

2. 【推荐】如果修改字段含义或对字段表示的状态追加时,需要及时更新字段注释。

3. 【推荐】字段允许适当冗余,以提高查询性能,但必须考虑数据一致。

   冗余字段应遵循:
   1 ) 不是频繁修改的字段。
   2 ) 不是 varchar 超长字段,更不能是 text 字段。
   正例:商品类目名称使用频率高,字段长度短,名称基本一成不变,可在相关联的表中冗余存储类目名称,避免关联查询。

4. 【推荐】单表行数超过 500 万行或者单表容量超过 2 GB ,才推荐进行分库分表。

   说明:如果预计三年后的数据量根本达不到这个级别,请不要在创建表时就分库分表。

建表规范[参考]

1. 【强制】业务上具有唯一特性的字段,即使是多个字段的组合,也必须建成唯一索引。

    说明:不要以为唯一索引影响了 insert 速度,这个速度损耗可以忽略,但提高查找速度是明显的 ; 另外,即使在应用层做了非常完善的校验控制,只要没有唯一索引,根据墨菲定律,必然有脏数据产生

2. 【强制】超过三个表禁止 join 。需要 join 的字段,数据类型必须绝对一致 ; 多表关联查询时,保证被关联的字段需要有索引。

   说明:即使双表 join 也要注意表索引、 SQL 性能

3. 【强制】在 varchar 字段上建立索引时,必须指定索引长度,没必要对全字段建立索引,根据实际文本区分度决定索引长度即可。
  
  说明:索引的长度与区分度是一对矛盾体,一般对字符串类型数据,长度为 20 的索引,区分 度会高达 90%以上,可以使用 count(distinct left( 列名, 索引长度 )) / count( * ) 的区分度 来确定。

4. 【强制】页面搜索严禁左模糊或者全模糊,如果需要请走搜索引擎来解决。

   说明:索引文件具有 B - Tree 的最左前缀匹配特性,如果左边的值未确定,那么无法使用此索 引
